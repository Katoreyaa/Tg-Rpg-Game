import asyncio
import logging
from re import A
import sys
from os import getenv
from xml.dom.minidom import Entity

from aiogram import Bot, Dispatcher, html
from aiogram.client.default import DefaultBotProperties
from aiogram.enums import ParseMode
from aiogram.filters import CommandStart
from aiogram.types import Message
from aiogram.types import InlineKeyboardButton, InlineKeyboardMarkup
from aiogram.types import CallbackQuery
import random
from classes import Entity, Enemy, Player, Create_Enemy

TOKEN = "8415236368:AAFgvzQWi4QvHP9RjIDnRuUtXCPKBbITnao"


Enemy = Create_Enemy()
Player = Entity(200, 20, 5)

bot = Bot(token=TOKEN)
dp = Dispatcher()
#fight encounter
#level up to the player

@dp.message(CommandStart())
async def command_start_handler(message: Message) -> None:
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(text="Attack", callback_data="attack"),
                InlineKeyboardButton(text="Do nothing", callback_data="nothing")
            ]
        ])
    await message.answer("Hello, you have an enemy in front of you, what would you like to do?",reply_markup=keyboard)

@dp.callback_query()
async def handle_callback(callback: CallbackQuery):
    if callback.data == "attack":
        Player.attack(Enemy)
        await callback.message.answer(f"You've attacked an enemy, enemy now has {Enemy.health} health")
    elif callback.data == "nothing":
        Enemy.attack(Player)
        await callback.message.answer(f"you have done nothing, enemy attacks you, you now have {Player.health} health")
    await callback.answer()
    




async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())


        